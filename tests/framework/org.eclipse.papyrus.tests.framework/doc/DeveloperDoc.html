<html><link rel="stylesheet" href="default.css" type="text/css"><H1>Papyrus Test Generation Framework</H1><pre>==Framework Goals==<BR/>* Automate the  development of test cases for Papyrus<BR/>* Set the bases for a model-based testing approach<BR/>* Ease the transition towards test-driven development</pre><pre>Currently, the framework supports the generation of unit tests for a diagram editor, taking as input an input .gmfgen. See below the generation workflow to understand how it works.</pre><H2>Requirements</H2><pre>- JUnit Generation (id=req01): <BR/> The framework shall allow to generate JUnit tests for UML diagram editors, its nodes and links</pre><pre>- Functional test cases (id=req02): <BR/> The framework shall test functional test cases: creation of elements, hide, delete, edition, drop from model explorer</pre><pre>- Extensibility (id=req03): <BR/> The framework shall be extensible with new diagram editors based on GMF</pre><pre>- Functional Coverage (id=req04): <BR/> The framework shall attain complete functional coverage for a diagram editor.</pre><pre>- Code Coverage (id=req05): <BR/> The framework shall cover all the possible code coverable by generated tests (expected to be around 80%)</pre><H2>Use Cases</H2><P align="middle"><img src=C:/Users/jc236769/OomphRoot/git/org.eclipse.papyrus/tests/framework/org.eclipse.papyrus.tests.framework/doc/imgDOC/UseCasesDiagram.png alt=UseCasesDiagram ></P><P align="middle">UseCasesDiagram</P></BR><pre>As a pre-requirement, the tests plug-in must have already been created.<BR/>Create tests plug-in, if it doesn't exist already. As a requirement, following the Papyrus development guidelines an Eclipse plug-in project must be created to contain the tests. Example: org.eclipse.papyrus.uml.diagram.component.tests.<BR/>Add the dependency in the plug-in manifest towards the testing framework: org.eclipse.papyrus.tests.framework.</pre><pre>Example: Generation for the UML Component diagram<BR/>Here is an example (componentdiagramtest.qvto):<BR/><BR/>import canonicalTests;<BR/><BR/>modeltype UML uses uml('http://www.eclipse.org/uml2/5.0.0/UML');<BR/><BR/>transformation componentdiagramtest(in gmfgenUml : UML, in gmfgenMm : UML, in frameworkBase : UML, in utp : UML, out testModel : UML) extends canonicalTests(in gmfgenUml : UML, in gmfgenMm : UML, in frameworkBase : UML, in utp : UML, out testModel : UML);<BR/><BR/>main() {<BR/>	topContainerEditPart := "PackageEditPart";<BR/>	topNodesToTest := Set{<BR/>		"PackageEditPart", <BR/>		"ModelEditPart", <BR/>		"ComponentEditPart", <BR/>		"InterfaceEditPart", <BR/>		"CommentEditPart", <BR/>		"ConstraintEditPart"<BR/>	} ;<BR/>	childNodesToTest := Set{<BR/>		"ModelEditPartCN", <BR/>		"PackageEditPartCN",<BR/>		"RectangleInterfaceEditPartCN" <BR/>		"ComponentEditPartCN", <BR/>		"ComponentEditPartPCN", <BR/>		"CommentEditPartPCN", <BR/>		"ConstraintEditPartPCN",<BR/>		"InterfaceEditPartPCN"<BR/>	};<BR/>	linksToTest := Set{<BR/>		"UsageEditPart",<BR/>		"InterfaceRealizationEditPart",<BR/>		"ManifestationEditPart",<BR/>		"ComponentRealizationEditPart",<BR/>		"AbstractionEditPart",<BR/>		"DependencyEditPart"<BR/>	};<BR/>	linksOwnedBySourceToTest := Set{<BR/>		"GeneralizationEditPart"<BR/>	};<BR/>	gmfgenUml.rootObjects()[UML::Model]->map gmfgen2papyrusTest("org.eclipse.papyrus.uml.diagram.component.test");<BR/>}<BR/><BR/><BR/>Here is an example for the workflow launcher:<BR/><BR/>package org.eclipse.papyrus.uml.diagram.component.test.generation<BR/><BR/>import org.eclipse.emf.mwe2.runtime.workflow.WorkflowContextImpl<BR/>import org.eclipse.papyrus.tests.framework.mwe.GenerateTestsWorkflow<BR/><BR/>class ComponentDiagramGenerateTestsWorkflow {<BR/><BR/>	def static void main(String[] args) {<BR/>		val workflow = new GenerateTestsWorkflow()<BR/>		workflow.uriPrefix = "platform:/resource"<BR/>		runWorkflow(workflow);<BR/>	}<BR/><BR/>	def static void runWorkflow(GenerateTestsWorkflow workflow) {<BR/>		workflow.gmfgenUri = workflow.uriPrefix + '/org.eclipse.papyrus.uml.diagram.component/model/ComponentDiagram.gmfgen'<BR/>		workflow.testSrcGenLocation = 'test-gen-15072014'<BR/>		workflow.qvtoScriptUri = workflow.uriPrefix + '/org.eclipse.papyrus.uml.diagram.component.tests/qvto/componentdiagramtest.qvto'<BR/>		workflow.testModelUri = workflow.uriPrefix + '/org.eclipse.papyrus.uml.diagram.component.tests/model/ComponentDiagramTest.uml'<BR/>		workflow.run(new WorkflowContextImpl());<BR/>	}<BR/><BR/>}<BR/><BR/></pre><H3>Define list of element edit parts under test</H3><pre>Create the QVTO script for your diagram editor, detailing the name of the generated package of tests and the desired edit parts to test, as they are described in the gmfgen (See example below). </pre><H3>Generate test model</H3><pre>Create the generation launcher (either Xtend-based or Java-based) in an appropiate package, for instance org.eclipse.papyrus.uml.diagram.component.test.generation, in a file such as ComponentDiagramGenerateTestsWorkflow.xtend. Copy the example launcher below and replace with the values for the generation parameters for your own diagram editor. The parameters are:<BR/>gmfgenUri: URI for the input GMFGen file<BR/>testSrcGenLocation: Folder in the project where the launcher is located where the test code will be generated, for instance test-gen.<BR/>qvtoScriptUri: URI for the QVTO script<BR/>testModelUri: URI where the UML-UTP intermediate model will be generated. After launching the generation, this model provides an overview of all the generated test artifacts.<BR/>Launch the main method as a normal Java class.<BR/>The intermediate model and the JUnit code are generated.</pre><H3>Generate JUnit test code</H3><pre>The generated JUnit tests extend the abstract test cases defined in the Papyrus test framework base</pre><P align="middle"><img src=C:/Users/jc236769/OomphRoot/git/org.eclipse.papyrus/tests/framework/org.eclipse.papyrus.tests.framework/doc/imgDOC/AbstractTestClassesDiagram.png alt=AbstractTestClassesDiagram ></P><P align="middle">AbstractTestClassesDiagram</P></BR><H2>Design</H2><P align="middle"><img src=C:/Users/jc236769/OomphRoot/git/org.eclipse.papyrus/tests/framework/org.eclipse.papyrus.tests.framework/doc/imgDOC/DesignOverview.png alt=DesignOverview ></P><P align="middle">DesignOverview</P></BR><P align="middle"><img src=C:/Users/jc236769/OomphRoot/git/org.eclipse.papyrus/tests/framework/org.eclipse.papyrus.tests.framework/doc/imgDOC/GenerationWorkflow.png alt=GenerationWorkflow ></P><P align="middle">GenerationWorkflow</P></BR><pre>This is the sequence of actions performed in the workflow to generate the tests. The input and output pins represent the inputs and outputs of every action.<BR/></pre><P align="middle"><img src=C:/Users/jc236769/OomphRoot/git/org.eclipse.papyrus/tests/framework/org.eclipse.papyrus.tests.framework/doc/imgDOC/ClassDiagram.png alt=ClassDiagram ></P><P align="middle">ClassDiagram</P></BR><pre>This is the structure of launchers for the generation workflow according to each type of diagram.</pre></html>